<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird Pro - Premium Edition</title>
    <meta name="description" content="Play Flappy Bird with custom graphics! Your favorite mobile game now with enhanced visuals and smooth gameplay.">
    <meta name="keywords" content="flappy bird, custom flappy bird, html5 game, mobile game">
    
    <!-- AdMob Integration -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-YOUR_ADMOB_ID" crossorigin="anonymous"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: #4EC0CA;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            touch-action: manipulation;
        }
        #game-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            height: 90vh;
            max-height: 600px;
            margin: auto;
            border: 3px solid #1a5b1a;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        #game {
            width: 100%;
            height: 100%;
            display: block;
            image-rendering: crisp-edges;
        }
        #score {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 42px;
            color: white;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
            z-index: 10;
            font-weight: bold;
        }
        #game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(0,0,0,0.85);
            color: white;
            z-index: 20;
            backdrop-filter: blur(5px);
        }
        #game-over h1 {
            font-size: 48px;
            margin-bottom: 30px;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        #restart-btn {
            padding: 12px 35px;
            font-size: 22px;
            background: linear-gradient(to bottom, #2AA347, #1E8449);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.2s;
        }
        #restart-btn:active {
            transform: scale(0.95);
        }
        #ad-container {
            position: absolute;
            bottom: 10px;
            width: 100%;
            height: 50px;
            display: flex;
            justify-content: center;
            z-index: 30;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="game" width="400" height="600"></canvas>
        <div id="score">0</div>
        <div id="game-over">
            <h1>Game Over</h1>
            <button id="restart-btn">Play Again</button>
        </div>
        <div id="ad-container"></div>
    </div>

    <!-- Audio Elements -->
    <audio id="flap-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-bird-flapping-1489.mp3" preload="auto"></audio>
    <audio id="score-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3" preload="auto"></audio>
    <audio id="hit-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-explosion-2759.mp3" preload="auto"></audio>

    <script>
        // Game elements
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const gameOverElement = document.getElementById('game-over');
        const restartBtn = document.getElementById('restart-btn');
        
        // Sound elements
        const flapSound = document.getElementById('flap-sound');
        const scoreSound = document.getElementById('score-sound');
        const hitSound = document.getElementById('hit-sound');

        // YOUR CUSTOM ASSETS
        const assets = {
            bird: new Image(),
            pipeTop: new Image(),
            pipeBottom: new Image(),
            background: new Image()
        };

        // Load your provided assets
        assets.bird.src = 'https://i.ibb.co/qMJt9NWZ/bird.png';       // Your bird image
        assets.pipeTop.src = 'https://i.ibb.co/8LP17MJj/pipe.png';    // Your pipe image
        assets.pipeBottom.src = 'https://i.ibb.co/8LP17MJj/pipe.png'; // Same pipe image (will be flipped)
        assets.background.src = 'https://i.ibb.co/d4NW8LtP/background.png'; // Your background

        // Game variables
        const bird = {
            x: 100,
            y: 300,
            width: 34,
            height: 24,
            velocity: 0,
            gravity: 0.5,
            jump: -8,
            rotation: 0
        };

        let pipes = [];
        let score = 0;
        let highScore = localStorage.getItem('flappyHighScore') || 0;
        let gameActive = true;
        let frameCount = 0;
        const pipeGap = 100;  // Optimal gap size
        const pipeWidth = 52;
        const pipeSpeed = 2.5;
        let lastPipeTime = 0;

        // Initialize AdMob
        function initAdMob() {
            if(typeof admob !== 'undefined') {
                admob.requestAd({
                    adType: admob.AD_TYPE.BANNER,
                    adSize: admob.AD_SIZE.SMART_BANNER,
                    position: admob.AD_POSITION.BOTTOM_CENTER,
                    publisherId: 'YOUR_ADMOB_ID' // Replace with your AdMob ID
                }, 
                function() {
                    admob.showAd(true);
                }, 
                function(error) { 
                    console.log('Ad failed: ' + error); 
                });
            }
        }

        // Game controls
        function handleInput(e) {
            if (e.code === 'Space' || e.type === 'click' || e.type === 'touchstart') {
                if (!gameActive) {
                    resetGame();
                    return;
                }
                bird.velocity = bird.jump;
                bird.rotation = -20; // Tilt up when flapping
                
                // Play flap sound
                flapSound.currentTime = 0;
                flapSound.play().catch(e => console.log('Audio play failed:', e));
            }
        }

        // Event listeners
        document.addEventListener('keydown', handleInput);
        canvas.addEventListener('click', handleInput);
        canvas.addEventListener('touchstart', handleInput, { passive: true });
        restartBtn.addEventListener('click', resetGame);

        // Create new pipes with your custom pipe image
        function createPipe() {
            const gapPosition = Math.random() * (canvas.height - pipeGap - 200) + 100;
            pipes.push({
                x: canvas.width,
                topHeight: gapPosition,
                bottomY: gapPosition + pipeGap,
                passed: false
            });
        }

        // Draw bird with your custom image and rotation
        function drawBird() {
            ctx.save();
            ctx.translate(bird.x + bird.width/2, bird.y + bird.height/2);
            ctx.rotate(bird.rotation * Math.PI / 180);
            
            if (assets.bird.complete) {
                ctx.drawImage(assets.bird, -bird.width/2, -bird.height/2, bird.width, bird.height);
            } else {
                // Fallback if image doesn't load
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.arc(0, 0, bird.width/2, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.restore();
            
            // Gradually increase rotation when falling
            if (bird.velocity > 0) {
                bird.rotation = Math.min(bird.rotation + 1, 25);
            }
        }

        // Draw pipes with your custom pipe image
        function drawPipes() {
            pipes.forEach(pipe => {
                if (assets.pipeTop.complete) {
                    // Top pipe (flipped vertically)
                    ctx.save();
                    ctx.translate(pipe.x + pipeWidth/2, pipe.topHeight);
                    ctx.scale(1, -1);
                    ctx.drawImage(assets.pipeTop, -pipeWidth/2, 0, pipeWidth, pipe.topHeight);
                    ctx.restore();
                    
                    // Bottom pipe
                    ctx.drawImage(assets.pipeBottom, pipe.x, pipe.bottomY, pipeWidth, canvas.height - pipe.bottomY);
                } else {
                    // Fallback if images don't load
                    ctx.fillStyle = '#2AA347';
                    ctx.fillRect(pipe.x, 0, pipeWidth, pipe.topHeight);
                    ctx.fillRect(pipe.x, pipe.bottomY, pipeWidth, canvas.height - pipe.bottomY);
                }
            });
        }

        // Draw background with your custom image
        function drawBackground() {
            if (assets.background.complete) {
                ctx.drawImage(assets.background, 0, 0, canvas.width, canvas.height);
            } else {
                // Fallback background
                ctx.fillStyle = '#4EC0CA';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
        }

        // Smooth game loop
        function update(timestamp) {
            if (!gameActive) return;

            // Clear and draw
            drawBackground();

            // Bird physics
            bird.velocity += bird.gravity;
            bird.y += bird.velocity;

            // Pipe generation with time-based interval
            if (timestamp - lastPipeTime > 1500) { // 1.5 seconds between pipes
                createPipe();
                lastPipeTime = timestamp;
            }

            // Pipe movement and collision
            pipes.forEach(pipe => {
                pipe.x -= pipeSpeed;

                // Score counting
                if (!pipe.passed && pipe.x + pipeWidth < bird.x) {
                    pipe.passed = true;
                    score++;
                    scoreElement.textContent = score;
                    
                    // Play score sound
                    scoreSound.currentTime = 0;
                    scoreSound.play().catch(e => console.log('Score sound error:', e));
                }

                // Collision detection
                const birdLeft = bird.x;
                const birdRight = bird.x + bird.width;
                const birdTop = bird.y;
                const birdBottom = bird.y + bird.height;

                if (birdRight > pipe.x && 
                    birdLeft < pipe.x + pipeWidth && 
                    (birdTop < pipe.topHeight || birdBottom > pipe.bottomY)) {
                    endGame();
                }
            });

            // Remove off-screen pipes
            pipes = pipes.filter(pipe => pipe.x > -pipeWidth);

            // Boundary collision
            if (bird.y + bird.height > canvas.height || bird.y < 0) {
                endGame();
            }

            // Draw game elements
            drawPipes();
            drawBird();

            requestAnimationFrame(update);
        }

        function endGame() {
            if (!gameActive) return;
            
            gameActive = false;
            gameOverElement.style.display = 'flex';
            
            // Play hit sound
            hitSound.currentTime = 0;
            hitSound.play().catch(e => console.log('Hit sound error:', e));
            
            // Update high score
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('flappyHighScore', highScore);
            }
        }

        function resetGame() {
            bird.y = 300;
            bird.velocity = 0;
            bird.rotation = 0;
            pipes = [];
            score = 0;
            gameActive = true;
            frameCount = 0;
            lastPipeTime = 0;
            scoreElement.textContent = '0';
            gameOverElement.style.display = 'none';
            requestAnimationFrame(update);
        }

        // Wait for assets to load
        let loadedAssets = 0;
        Object.values(assets).forEach(img => {
            img.onload = () => {
                loadedAssets++;
                if (loadedAssets === Object.keys(assets).length) {
                    initAdMob();
                    requestAnimationFrame(update);
                }
            };
            img.onerror = () => {
                console.log('Failed to load image:', img.src);
                loadedAssets++;
                if (loadedAssets === Object.keys(assets).length) {
                    initAdMob();
                    requestAnimationFrame(update);
                }
            };
        });

        // Start game if all assets are already loaded
        if (Object.values(assets).every(img => img.complete)) {
            initAdMob();
            requestAnimationFrame(update);
        }
    </script>
</body>
      </html>
